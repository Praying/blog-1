---
title: 震惊！竟然有公司在圣诞礼物中放这个！
date: 2018-12-25
tag: 文章
cover: https://imgkr.cn-bj.ufileos.com/94784c4d-0cb7-4fc1-9eae-a91f5abcdb2f.png
---


虽然没能入职，依然向我要了地址发了圣诞礼物，感谢图森未来

礼物到了我迫不及待的拆开，照了两张照片，没错，就是下面这两张照片

<img width="545" alt="4" src="https://user-images.githubusercontent.com/13995641/50414007-c90bab80-084d-11e9-96af-015ef58b43c9.png">

<img width="595" alt="5" src="https://user-images.githubusercontent.com/13995641/50414008-c9a44200-084d-11e9-8f96-2c0f5d07b20d.png">


本来我觉得礼物很不错，毕竟都是吃的，很合我的胃口，连勺都配好了，正准备吃里面的圣诞礼物...

万万没想到的是礼物中居然还有一份儿代码，怕看错了又仔细看了下，嗯...emmm，没错，有高亮有缩进，确定是代码无疑了

<img width="667" alt="1" src="https://user-images.githubusercontent.com/13995641/50413691-bdb78080-084b-11e9-934d-0a3da7818a26.png">

作为程序员的我异常敏感，需求和考验来了！我放下了手中的勺子，走到了电脑前。

看来目标就是需要进入卡片下方的[破译网站](http://xmas2018.tusimple.com/)，这个网站是个编译器，能把上面圣诞树代码解析出来，网站提示这个代码是用`Brainfuck`这门语言写的，这语言名字，，，真给劲，，，把这些字符串都敲进去，应该不会很困难吧，于是老眼昏花的我就开始敲，代码如下：

```
                     +>+++++
                   +++[<++++>-]>
                  ++++++++[<++++++
                ++>-]>++++++++++[<+++
                  +++++++>-]<<+++++
                +++++++++++++++.>++++
             +++++++++++++.<-.>-----------
             -.++++.+++.----.-------.<<.>
              >++++++++++++++++++.------
        --------.++++++++++.-----------.<<.>>++
            +++++++++++++++.----------.+++
    +++.<<.>>--------------------.<<.>-----.>++++.++
   +++++++++++..+++++++.<<.>----------.>-------------
----.++++++++++.---------.++++++++++.+.-------.----------
               -.++++++++++++++++++.<<+.
```
我觉得我代码风格还是挺不错的，缩进的很到位，只不过高亮实在是做不到。

马上就要运行代码了，有点学生时代两个人传暗号小纸条的感受，还有点小期待呢。满怀期待的我把代码放到了编译器上运行，结果如下：

<img width="803" alt="2" src="https://user-images.githubusercontent.com/13995641/50413441-30276100-084a-11e9-8a2a-19f541f38312.png">


emmm，这结果不太对吧，看这句话的意思应该是：`图森祝你圣诞快乐`，机智的我打开了谷歌翻译，果然这句话的英文应该是`TuSimple wish you a Merry Christmas!`

完了，果然老眼昏花敲错了，敲得时候我就说可别敲错了，这都没法debug。

先去看看语法吧，维基百科讲的还是很清楚的，看完之后我觉得这门语言设计的真不错，果然是wtf。

仔细看了下错误，发现和准确的英文相比其实ASCII码就差了1，比如`Dhristmbt`应该是`Christmas`，其中错的三个字符都是差了1，空格和!也是差了1，估计是少打了个符号？

万幸，找到了一个[在线Brainfuck调试器](https://www.iamcal.com/misc/bf_debug/)，能单步调试的代码都不是事儿

经过调试我发现，`[]`代表循环结构，其中前面的循环结构都是在给3个连续内存地址赋值初始化，这3个地址按顺序分别用于

- 存储标点符号的ASCII码
- 存储大写字母的ASCII码
- 存储小写字母的ASCII码

如下图所示，#代表断点

<img width="1004" alt="3" src="https://user-images.githubusercontent.com/13995641/50413461-4d5c2f80-084a-11e9-934d-928b3b16ff39.png">

`<`和`>`负责向前和向后移动指针，`+`和`-`负责给当前值加1和减1，`.`负责打印，也就是从初始化之后（上图的`#`位置），根据`.`字符进行分割，不断移动指针和修改ASCII码，一个字母一个字母的打印出了`TuSimple!wish!you!a!Nerry!Dhristmbt"`。

根据上述结论，我发现，，，我根本就没打错，，，代码本来就有三处bug，看来果然是图森的考验，哈哈

修正后的代码如下：

```
                     >+++++ //多了一个加号
                   +++[<++++>-]>
                  ++++++++[<++++++
                ++>-]>++++++++++[<+++
                  +++++++>-]<<+++++
                +++++++++++++++.>++++
             +++++++++++++.<-.>-----------
             -.++++.+++.----.-------.<<.>
              >++++++++++++++++++.------
        --------.++++++++++.-----------.<<.>>++
            +++++++++++++++.----------.+++
    +++.<<.>>--------------------.<<.>------.>++++.++ //少了一个减号
   +++++++++++..+++++++.<<.>----------.>-------------
----.++++++++++.---------.++++++++++.+.-------.----------
               --.++++++++++++++++++.<<+. //少了一个减号
```
没有高亮凑合看吧，结果图如下：

<img width="820" alt="4" src="https://user-images.githubusercontent.com/13995641/50413473-6cf35800-084a-11e9-87d4-fe71caead846.png">

总算结束了，可以继续吃了，祝图森未来一路顺风，祝大家圣诞节快乐，全剧终。

## 参考链接

- [震惊！图森未来竟然在圣诞礼物中放这个！](https://www.nowcoder.com/discuss/148972)